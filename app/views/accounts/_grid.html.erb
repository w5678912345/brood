<%= grid(@accounts, show_filters: :no) do |g|
  g.action_column  object_property: :no
  g.column name:  'ID', attribute: 'id', filter: false
  g.column name:  'Account' do |task|
    r = account_tag(task)#
    r += raw('<i class="icon-flag" title="IP: '+task.ip_range+'"></i>') unless task.ip_range.blank?
    r
  end
  g.column name:  '区', attribute: 'server'
  g.column name:  '角色数', attribute: 'roles_count',filter: false
  g.column name: '绑定机器' ,attribute: 'bind_computer_id',filter: false do |task|
     account_bind_tag task
  end
  g.column name: '在线',filter: false do |account|
    if account.is_started?
      r = raw("#{account.session_id}#{notes_link_tag(:session_id => account.session_id )}") if account.session_id>0
      r += link_to account.session.ip,notes_path(:ip => account.session.ip)

      r += account.online_role_id ==0 ? 'No Role ' : link_to(account.online_role_id,role_path(account.online_role.id))
      r
    else
      normal_at_tag account.normal_at
    end
  end
  g.column name:  '状态', attribute: 'status'
  g.column name:  "冷却时间",attribute: 'normal_at'  do |task|
    time_str task.normal_at
  end
  g.column name:  "成功",attribute: 'today_success'  do |task|
    boolean_tag task.today_success
  end
end %>