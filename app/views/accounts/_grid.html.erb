<%= grid(@accounts || accounts, upper_pagination_panel: true, show_filters: :yes) do |g|
  g.action_column  object_property: :no
  g.column name:  'ID', attribute: 'id', filter: false
  g.column name:  'Account' do |task|
    r = account_tag(task)#
    r += raw('<i class="icon-flag" title="IP: '+task.ip_range+'"></i>') unless task.ip_range.blank?
    r
  end
  g.column name:  'rms_file', attribute: 'rms_file',in_csv: false  do |account|
    boolean_tag account.rms_file
  end
  g.column name:  'Enabled', attribute: 'enabled',in_csv: false  do |account|
    boolean_tag account.enabled
  end
   g.column name:  'In CPO', attribute: 'in_cpo',in_csv: false do |account|
    boolean_tag account.in_cpo
  end
  g.column name:  '区', attribute: 'server'
  g.column name:  '角色数', attribute: 'roles_count',in_csv: false 
  g.column name:  '点券', attribute: 'money_point',filter_type: :range,in_csv: false 

  g.column name: '绑定机器' ,attribute: 'bind_computer_id',filter: false,in_csv: false  do |task|
     account_bind_tag task
  end
  g.column name: '在线', attribute: 'session_id', filter: false,in_csv: false  do |account|
    if account.is_started?
      r = raw("#{account.session_id}#{notes_link_tag(:session_id => account.session_id )}") if account.account_session
      r += link_to account.account_session.ip+' ',account_sessions_path(:grid => {:f => {:ip => account.account_session.ip}})

      r += account.online_role_id ==0 ? 'No Role ' : link_to(account.online_role_id,role_path(account.online_role.id))
    end
  end
  g.column name:  '状态', attribute: 'status' ,custom_filter: Account.all_status do |account|
    account.standing ? "[站]#{account.status}" : account.status
  end
  g.column name:  "冷却时间",attribute: 'normal_at',in_csv: false   do |task|
    normal_at_tag task.normal_at
  end
  g.column name:  "成功",attribute: 'today_success',in_csv: false   do |task|
    boolean_tag task.today_success
  end
end %>
